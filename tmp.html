<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>

  <link rel="stylesheet" href="css/bootstrap.min.css">
  <script src="js/jquery-3.6.4.min.js"></script>
  <script src="js/bootstrap.bundle.min.js"></script>

  <style>
    .cart-item {
      display: flex;
      align-items: center;
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 10px;
      margin-bottom: 10px;
      height: 150px;
    }

    .cart-item img {
      width: 130px;
      height: 130px;
      margin-right: 10px;
      margin-left: 40px;
      border: 1px solid gray;
    }

    .cart-item-info {
      flex: 1;
      display: flex;
      flex-wrap: wrap;
    }

    .cart-item-name {
      flex-basis: 100%;
      margin-bottom: 5px;
      font-weight: bold;
      margin-top: -40px;
      padding-left: 30px;
      font-size: 18px;
      color: #6DBDFB;
    }

    .cart-item-quantity,
    .cart-item-price {
      margin-left: 4vh;
    }

    .cart-item-price {
      font-size: 18px;
      font-weight: bold;
      margin-top: 10px;
      color: red;
    }



    .cart-item-quantity:after {
      content: "Price";
      margin-left: 10px;
      margin-right: 10px;
    }

    /* burtton đặt hàng */
    .checkout-button {
      background-color: #6DBDFB;
      color: white;
      padding: 10px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      margin: 4px 2px;
      cursor: pointer;
      border-radius: 10px;
      border: 0px;
    }

    .checkout-button:hover {
      background-color: #6DBDFB;
      color: black;
      font-weight: bold;
      padding: 10px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      margin: 4px 2px;
      cursor: pointer;
      border-radius: 10px;
      border: 0px;
    }

    /* button tăng giảm số lượng sản phẩm */
    /* Tăng */
    .cart-item-quantity-button {
      border: none;
      background-color: #fff;
      color: #33FF00;
      font-size: 1.5rem;
      font-weight: bold;
      padding: 0.25rem 0.5rem;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
    }

    .cart-item-quantity-button:hover {
      background-color: #33FF00;
      color: #fff;
    }

    /* giảm */
    .minus-button {
      border: none;
      background-color: #fff;
      color: #ff6347;
      font-size: 1.5rem;
      font-weight: bold;
      padding: 0.25rem 0.5rem;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
    }

    .minus-button:hover {
      background-color: #ff6347;
      color: #fff;
    }

    /* test */
    @keyframes blink {
      0% {
        background-color: #fff;
      }

      50% {
        background-color: #ffff00;
      }

      100% {
        background-color: #fff;
      }
    }

    .blink {
      animation: blink 1s infinite;
    }
  </style>

  <script>
    // Lấy danh sách sản phẩm từ localStorage
    let cartItems = JSON.parse(localStorage.getItem("cart")) || [];

    // Hiển thị danh sách sản phẩm trên trang
    const cartItemsDiv = document.querySelector("#cart-items");
    cartItems.forEach((item) => {

      // Kiểm tra xem sản phẩm đã tồn tại trong giỏ hàng chưa
      const existingCartItem = cartItems.find((cartItem) => cartItem.name === item.name);
      if (existingCartItem) {
      } else {
        // Nếu sản phẩm chưa tồn tại, thêm sản phẩm mới vào giỏ hàng
        cartItems.push({
          name: item.name,
          price: item.price,
          image: item.image,
          quantity: 1,
        });
      }

      // Tạo phần tử HTML để hiển thị thông tin sản phẩm
      const cartItem = document.createElement("div");
      cartItem.classList.add("cart-item");

      const cartItemImage = document.createElement("img");
      cartItemImage.src = `images/${item.image}`;
      cartItem.appendChild(cartItemImage);

      const cartItemInfo = document.createElement("div");
      cartItemInfo.classList.add("cart-item-info");

      const cartItemName = document.createElement("div");
      cartItemName.classList.add("cart-item-name");
      cartItemName.innerText = item.name;
      cartItemInfo.appendChild(cartItemName);

      // chức năng tăng giảm số lượng sản phẩm
      const cartItemQuantity = document.createElement("div");
      cartItemQuantity.classList.add("cart-item-quantity");
      const quantityLabel = document.createElement("span");
      quantityLabel.innerText = "Quantity: ";
      cartItemQuantity.appendChild(quantityLabel);
      const quantity = document.createElement("span");
      quantity.innerText = item.quantity;
      cartItemQuantity.appendChild(quantity);

      // Thêm class cho button tăng số lượng sản phẩm
      const minusButton = document.createElement("button");
      minusButton.classList.add("minus-button"); // Thêm class "minus-button"
      minusButton.innerText = "-";
      minusButton.addEventListener("click", () => {
        if (item.quantity > 1) {
          item.quantity--;
          quantity.innerText = item.quantity;
          localStorage.setItem("cart", JSON.stringify(cartItems));
        } else {
          // Xóa sản phẩm khỏi danh sách
          const index = cartItems.findIndex((cartItem) => cartItem.name === item.name);
          cartItems.splice(index, 1);
          localStorage.setItem("cart", JSON.stringify(cartItems));
          // Xóa phần tử HTML tương ứng trên trang
          cartItem.remove();
        }
      });

      cartItemQuantity.appendChild(minusButton);
      quantity.innerText = item.quantity;
      cartItemQuantity.appendChild(quantity);

      // Thêm class cho button tăng số lượng sản phẩm
      const plusButton = document.createElement("button");
      plusButton.innerText = "+";
      plusButton.classList.add("cart-item-quantity-button");
      plusButton.classList.add("cart-item-quantity-button-plus");
      plusButton.addEventListener("click", () => {
        item.quantity++;
        quantity.innerText = item.quantity;
        localStorage.setItem("cart", JSON.stringify(cartItems));
      });
      cartItemQuantity.appendChild(plusButton);

      cartItemInfo.appendChild(cartItemQuantity);

      const cartItemPrice = document.createElement("div");
      cartItemPrice.classList.add("cart-item-price");
      cartItemPrice.innerText = item.price + "$";
      cartItemInfo.appendChild(cartItemPrice);

      cartItem.appendChild(cartItemInfo);

      // Thêm button đặt hàng
      const checkoutButton = document.createElement("button");
      checkoutButton.setAttribute("class", "checkout-button");
      checkoutButton.innerText = "Order Now";
      checkoutButton.addEventListener("click", () => {
        // Thêm xử lý đặt hàng ở đây
        alert("Đơn hàng của bạn đã được đặt thành công. Chúng tôi sẽ liên hệ với bạn sớm nhất có thể. Trân trọng cảm ơn !")
      });
      cartItem.appendChild(checkoutButton);

      // Thêm sản phẩm vào danh sách
      cartItemsDiv.appendChild(cartItem);
    });

    // Lưu danh sách sản phẩm mới vào localStorage
    localStorage.setItem("cart", JSON.stringify(cartItems));

    function clearAll() {
      localStorage.clear();
      location.reload();
    }
  </script>
</head>

<body>
  <div id="cart-items" class="d-flex flex-column">
    <!-- procudt item -->
  </div>
</body>

</html>